"use strict";

import * as request from "supertest";
import * as mocha from "mocha";
import * as chai from "chai";

const servers: string[] = ["http://localhost:9090"];
const lynxCode: string = "CPS-407-OEM-0186161B2";

const server: string = servers[0];

console.log("Testing the following server: " + server);

describe("Check handwriting API accepts input", function () {
  this.slow(900);

  it("Performs Handwriting recognition on Hello", (done) => {
    request(server)
      .post("/api-v2/recognise")
      .type("form")
      .send({
        recognitionType: "handwriting",
        languageISO: "en_GB",
        jsonData: helloPath,
      })
      .expect(200)
      .end(function (err, res) {
        if (err) return done(err);
        chai.expect(res.body.label).eql("Hello");
        done();
      });
  });
});

const helloPath: string =
  '{\n "paths": [\n {\n "x": [\n 301.5297408999421,\n 301.56465494357514,\n 304.51007202074175,\n 304.64972819527384,\n 304.8242984134389,\n 304.99886863160395,\n 305.17343884976907,\n 305.38292311156715,\n 305.59240737336523,\n 304.6259524674606,\n 305.11474907832286,\n 305.35914738375396,\n 305.6384597328181,\n 305.8828580382492,\n 306.1272563436803,\n 306.3367406054784,\n 306.58113891090954,\n 306.7906231727076,\n 307.0001074345057,\n 307.17467765267077,\n 307.3492478708359,\n 306.2780508340323,\n 306.4177070085644,\n 306.4875350958304,\n 306.5224491394634,\n 306.62719127036246,\n 306.6621053139955,\n 306.6970193576285,\n 305.4163380590268,\n 302.75023333092446\n ],\n "y": [\n 228.50244273642474,\n 229.7132959477604,\n 247.80626603052906,\n 252.64967887587164,\n 258.7039449325499,\n 264.7582109892282,\n 270.81247704590635,\n 278.07759631392025,\n 285.34271558193416,\n 293.8536021049167,\n 310.80554706361585,\n 319.2815195429654,\n 328.96834523365055,\n 337.4443177130001,\n 345.92029019234957,\n 353.1854094603635,\n 361.661381939713,\n 368.9265012077269,\n 376.1916204757408,\n 382.245886532419,\n 388.30015258909725,\n 393.1784794780729,\n 398.02189232341544,\n 400.44359874608676,\n 401.65445195742245,\n 405.28701159142935,\n 406.49786480276504,\n 407.70871801410067,\n 405.32192563506237,\n 396.9157812429789\n ]\n },\n {\n "x": [\n 292.65707652863625,\n 297.53540341761186,\n 307.2222291082971,\n 316.9439688426153,\n 326.66570857693347,\n 338.77424069028996,\n 344.8285067469682,\n 347.2502131696395,\n 348.4610663809751,\n 349.67191959231076,\n 350.88277280364645,\n 352.0936260149821,\n 353.3044792263177,\n 353.23465113905166,\n 354.41059030675433,\n 354.27093413222224\n ],\n "y": [\n 299.0461553865895,\n 300.117352423393,\n 299.8380400743289,\n 300.76958093660045,\n 301.70112179887195,\n 301.35198136254184,\n 301.1774111443767,\n 301.1075830571107,\n 301.0726690134777,\n 301.0377549698447,\n 301.00284092621166,\n 300.96792688257864,\n 300.9330128389456,\n 298.5113064162743,\n 297.26553916130564,\n 292.42212631596306\n ]\n },\n {\n "x": [\n 350.0336974406341,\n 349.6956953201239,\n 350.3939761927842,\n 350.88277280364645,\n 352.3380243204132,\n 352.7220788003763,\n 352.9664771058075,\n 353.17596136760557,\n 353.38544562940365,\n 354.80578310253736,\n 354.9803533207025,\n 356.5054329247353,\n 356.6800031429004,\n 356.8196593174324,\n 356.9244014483315,\n 358.20508274693316,\n 358.30982487783217,\n 358.3796529650982,\n 358.41456700873124,\n 358.3447389214652\n ],\n "y": [\n 229.52758741377542,\n 259.8338317407996,\n 284.0508959675126,\n 301.00284092621166,\n 309.44389936192823,\n 322.7632846866203,\n 331.23925716596983,\n 338.50437643398374,\n 345.76949570199764,\n 352.99970092637847,\n 359.05396698305674,\n 369.9167318414445,\n 375.9709978981228,\n 380.8144107434653,\n 384.4469703774723,\n 386.83376275651057,\n 390.4663223905175,\n 392.88802881318884,\n 394.09888202452447,\n 391.6771756018532\n ]\n },\n {\n "x": [\n 377.81199411791465,\n 393.5879999089111,\n 417.77015009199107,\n 449.0428493249198,\n 465.7853100218208,\n 468.1371883572261,\n 471.595177773068,\n 471.5253496858019,\n 471.4555215985359,\n 471.38569351126984,\n 471.31586542400385,\n 468.78941687043346,\n 467.5087355718318,\n 465.05211510552743,\n 462.59549463922315,\n 460.13887417291886,\n 458.92802096158323,\n 456.5063145389119,\n 454.08460811624064,\n 452.873754904905,\n 450.4520484822337,\n 449.276109314531,\n 446.85440289185976,\n 445.6784637241571,\n 442.1157321774162,\n 439.7289397983779,\n 437.3770614629727,\n 436.20112229527007,\n 433.84924395986474,\n 432.7082188357951,\n 430.3563405003899,\n 427.96954812135164,\n 426.828522997282,\n 425.68749787321235,\n 424.5464727491427,\n 423.4054476250731,\n 422.26442250100354,\n 422.2993365446365,\n 421.1583114205669,\n 421.22813950783296,\n 421.263053551466,\n 421.367795682365,\n 421.402709725998,\n 421.47253781326407,\n 422.78813315549877,\n 422.85796124276476,\n 424.13864254136644,\n 426.6301770513038,\n 427.91085834990554,\n 430.3674788162098,\n 432.8590133261471,\n 435.3156337924514,\n 437.77225425875577,\n 441.4397279363957,\n 445.1072016140357,\n 447.528908036707,\n 451.1614676707139,\n 456.0048805160565,\n 459.63744015006347,\n 462.05914657273473,\n 466.9025594180773,\n 469.2893517971156,\n 472.88699738748954,\n 475.27378976652784,\n 477.6605821455661,\n 478.8365213132687,\n 481.25822773594,\n 482.4341669036427,\n 484.78604523904795,\n 484.7511311954149,\n 485.8921563194845,\n 487.0680954871871,\n 489.41997382259245,\n 491.63219598346564\n ],\n "y": [\n 352.33633409735114,\n 353.09330474145764,\n 351.18417065746166,\n 343.0112862549894,\n 335.2573703761132,\n 332.76583586617596,\n 326.6068276785986,\n 324.18512125592736,\n 321.763414833256,\n 319.3417084105847,\n 316.92000198791345,\n 313.3572704411725,\n 310.97047806213425,\n 309.8294529380646,\n 308.688427813995,\n 307.54740268992543,\n 307.58231673355846,\n 307.6521448208245,\n 307.7219729080905,\n 307.7568869517235,\n 307.82671503898956,\n 309.0724822939582,\n 309.14231038122426,\n 310.38807763619286,\n 312.9145261897632,\n 314.1952074883649,\n 316.6867419983023,\n 317.93250925327095,\n 320.4240437632082,\n 322.8806642295125,\n 325.3721987394499,\n 326.6528800380516,\n 329.1095005043559,\n 331.56612097066017,\n 334.0227414369645,\n 336.4793619032688,\n 338.9359823695731,\n 340.14683558090877,\n 342.60345604721306,\n 345.0251624698844,\n 346.23601568122,\n 349.86857531522696,\n 351.0794285265626,\n 353.5011349492339,\n 357.09878053960784,\n 359.5204869622791,\n 361.9072793413174,\n 364.2591576767227,\n 366.645950055761,\n 367.78697517983056,\n 370.13885351523584,\n 371.2798786393055,\n 372.4209037633751,\n 373.5270148438117,\n 374.63312592424825,\n 374.5632978369822,\n 374.4585557060832,\n 374.3188995315511,\n 374.2141574006521,\n 374.14432931338604,\n 374.00467313885395,\n 372.7239918402523,\n 371.4083964980176,\n 370.12771519941595,\n 368.84703390081427,\n 367.60126664584556,\n 367.5314385585795,\n 366.28567130361085,\n 363.79413679367354,\n 362.5832835823379,\n 360.12666311603357,\n 358.8808958610649,\n 356.3893613511276,\n 349.05441399584765\n ]\n },\n {\n "x": [\n 501.2269169552449,\n 501.29674504251096,\n 501.68079952247416,\n 501.75062760974015,\n 501.8553697406392,\n 501.89028378427224,\n 502.0648540024373,\n 502.16959613333637,\n 502.2743382642354,\n 503.6248476501031,\n 503.7295897810021,\n 503.8692459555342,\n 505.2197553414019,\n 506.60517877090274,\n 506.70992090180175,\n 506.8844911199669,\n 506.95431920723286,\n 507.0241472944989,\n 508.30482859310064,\n 508.3397426367336,\n 508.3746566803667,\n 508.40957072399965,\n 508.4444847676326,\n 508.4793988112657,\n 509.69025202260127,\n 509.6553379789683,\n 510.79636310303795,\n 510.7265350157719,\n 511.86756013984143,\n 512.9736712202781\n ],\n "y": [\n 261.5238423433509,\n 263.94554876602217,\n 277.2649340907143,\n 279.68664051338556,\n 283.3192001473925,\n 284.53005335872814,\n 290.5843194154064,\n 294.2168790494133,\n 297.8494386834203,\n 302.6579374851298,\n 306.29049711913683,\n 311.13390996447936,\n 315.94240876618903,\n 321.9617607792342,\n 325.5943204132412,\n 331.64858646991945,\n 334.0702928925907,\n 336.491999315262,\n 338.8787916943003,\n 340.0896449056359,\n 341.3004981169716,\n 342.5113513283072,\n 343.72220453964286,\n 344.93305775097855,\n 344.8981437073455,\n 343.68729049600984,\n 341.23067002970555,\n 338.80896360703423,\n 336.3523431407299,\n 332.68486946308997\n ]\n },\n {\n "x": [\n 522.9175326283876,\n 521.776507504318,\n 522.3351322024463,\n 522.4747883769783,\n 522.7541007260425,\n 524.2442662864421,\n 526.9452850581777,\n 529.8208740480782,\n 532.5917209070795,\n 533.8724022056812,\n 535.1879975479159,\n 535.2578256351819,\n 535.327653722448,\n 536.6083350210497,\n 536.6432490646827,\n 536.6781631083157,\n 536.7130771519487,\n 537.9239303632843,\n 539.099869530987,\n 540.2758086986896,\n 541.3819197791263,\n 543.7687121581646,\n 544.9097372822342\n ],\n "y": [\n 257.26282992394965,\n 259.719450390254,\n 279.0931017716243,\n 283.93651461696686,\n 293.62334030765203,\n 303.27525195470423,\n 312.89224955812347,\n 328.5635132182208,\n 340.60221724431125,\n 342.9890096233495,\n 346.5866552137235,\n 349.0083616363948,\n 351.43006805906606,\n 353.81686043810436,\n 355.02771364944,\n 356.2385668607756,\n 357.44942007211125,\n 357.41450602847823,\n 356.1687387735096,\n 354.9229715185409,\n 351.25549784090094,\n 349.97481654229927,\n 347.5181960759949\n ]\n },\n {\n "x": [\n 581.0147110446857,\n 578.6279186656473,\n 564.3071643914176,\n 561.9203720123793,\n 560.7793468883098,\n 560.8840890192088,\n 559.7779779387722,\n 558.6369528147027,\n 558.7766089892347,\n 558.8464370765007,\n 558.9162651637668,\n 558.9860932510328,\n 559.0908353819318,\n 560.3715166805334,\n 560.4413447677995,\n 561.7220260664012,\n 563.0027073650028,\n 564.2484746199715,\n 564.2833886636046,\n 565.5291559185731,\n 570.5122249384478,\n 576.6014050387591,\n 586.3580588167102,\n 598.4665909300668,\n 605.6618821108145,\n 612.7873452042966,\n 616.2104205765054,\n 618.4226427373785,\n 618.2829865628465,\n 618.1782444319474,\n 618.1433303883144,\n 618.0735023010484,\n 618.0036742137823,\n 617.9338461265163,\n 616.6531648279146,\n 615.372483529313,\n 615.3026554420469,\n 614.0568881870782,\n 612.8111209321097,\n 612.7412928448437,\n 611.4955255898749,\n 610.2497583349061,\n 607.7931378686018,\n 605.3365174022975,\n 604.0907501473289,\n 601.6690437246576,\n 600.423276469689,\n 599.2124232583533,\n 598.0015700470177,\n 596.790716835682,\n 595.5798636243463,\n 594.3690104130108,\n 593.1581572016751,\n 591.9473039903394\n ],\n "y": [\n 296.7908790586099,\n 298.0715603572116,\n 305.7556481488217,\n 307.0363294474233,\n 309.4929499137276,\n 313.1255095477346,\n 316.79298322537454,\n 319.24960369167883,\n 324.09301653702147,\n 326.51472295969273,\n 328.93642938236405,\n 331.3581358050354,\n 334.99069543904227,\n 337.37748781808057,\n 339.7991942407519,\n 342.1859866197901,\n 344.5727789988284,\n 345.74871816653103,\n 346.95957137786667,\n 348.1355105455694,\n 352.8392672163799,\n 353.87555020955045,\n 356.0179442831576,\n 355.6688038468274,\n 353.03761316235807,\n 347.98471605521735,\n 340.61485465630443,\n 333.2799073010245,\n 328.43649445568195,\n 324.80393482167494,\n 323.5930816103393,\n 321.17137518766805,\n 318.7496687649967,\n 316.3279623423254,\n 313.94116996328717,\n 311.5543775842489,\n 309.13267116157755,\n 307.95673199387494,\n 306.7807928261723,\n 304.359086403501,\n 303.1831472357984,\n 302.0072080680958,\n 300.8661829440261,\n 299.7251578199565,\n 298.5492186522539,\n 298.6190467395199,\n 297.4431075718173,\n 297.4780216154503,\n 297.5129356590833,\n 297.54784970271635,\n 297.58276374634937,\n 297.6176777899824,\n 297.65259183361536,\n 297.6875058772484\n ]\n }\n ],\n "version": "1.0"\n}\n';
